#!/usr/bin/env ruby

unless defined? JRUBY_VERSION
  raise "This application must be run under JRuby"
end

require 'optparse'

options = {}
opt_parser = OptionParser.new do |opts|
  opts.banner = "Usage: magnetizer [options] file"

  opts.on("-v", "--[no-]verbose", "Run verbosely") do |v|
    options[:verbose] = v
  end

  opts.on_tail("-h", "--help", "Show this message") do
    puts opts
    exit
  end
end

opt_parser.parse!

file = ARGV.first

if file.nil? || file.empty? 
  puts "No file specified"
  puts opt_parser
  exit
end

puts "Running the magnetizer on #{file}"

$CLASSPATH << "java/bin/"

require "lib/magnetizer.rb"
magnetizer = Magnetizer.new(file)
# magnetizer.show_gui_tree
magnetizer.print_magnets

puts "After running"
